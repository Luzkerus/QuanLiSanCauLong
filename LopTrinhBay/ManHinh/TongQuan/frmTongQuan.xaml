<Window x:Class="QuanLiSanCauLong.LopTrinhBay.ManHinh.TongQuan.frmTongQuan"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        mc:Ignorable="d"
        Title="Tổng quan hệ thống"
        MinWidth="1200" MinHeight="700"
        WindowState="Maximized"
        Background="#F6FDF9"
        WindowStartupLocation="CenterScreen">

    <!-- =================== RESOURCES =================== -->
    <Window.Resources>
        <!-- Palette (khớp frmQuanLySan) -->
        <SolidColorBrush x:Key="ColText"     Color="#21382D"/>
        <SolidColorBrush x:Key="ColSub"      Color="#6B7E74"/>
        <SolidColorBrush x:Key="ColBorder"   Color="#E1F0E9"/>
        <SolidColorBrush x:Key="ColCard"     Color="White"/>
        <SolidColorBrush x:Key="ColAccent"   Color="#2BB673"/>
        <SolidColorBrush x:Key="ColAccentDark" Color="#0D7049"/>

        <!-- Card -->
        <Style x:Key="CardBorder" TargetType="Border">
            <Setter Property="CornerRadius" Value="14"/>
            <Setter Property="Background" Value="{StaticResource ColCard}"/>
            <Setter Property="BorderBrush" Value="{StaticResource ColBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.15"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Badge nhỏ -->
        <Style x:Key="Badge" TargetType="Border">
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="10,3"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <!-- Ô tìm kiếm (giữ nguyên logic watermark của QuanLySan) -->
        <Style x:Key="WatermarkTextStyle" TargetType="TextBlock">
            <Setter Property="Visibility" Value="Visible"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding Text, ElementName=txtSearch}" Value="">
                    <Setter Property="Visibility" Value="Visible"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Text.Length, ElementName=txtSearch}" Value="0">
                    <Setter Property="Visibility" Value="Visible"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Text, ElementName=txtSearch}" Value="{x:Null}">
                    <Setter Property="Visibility" Value="Visible"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding Text.Length, ElementName=txtSearch}" Value="1">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- Nút solid (Border + Trigger hover như QuanLySan) -->
        <Style x:Key="BtnSolid" TargetType="Border">
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Background" Value="{StaticResource ColAccent}"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="6" ShadowDepth="1" Opacity="0.18"/>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource ColAccentDark}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Nút viền (outline) -->
        <Style x:Key="BtnOutline" TargetType="Border">
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="{StaticResource ColAccent}"/>
            <Setter Property="BorderThickness" Value="1.2"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#EAF6EF"/>
                    <Setter Property="BorderBrush" Value="#0D7049"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Menu item -->
        <Style x:Key="MenuItemNormal" TargetType="Border">
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="14,12"/>
            <Setter Property="Margin" Value="12,6,12,0"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#F2FBF7"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="MenuItemActive" BasedOn="{StaticResource MenuItemNormal}" TargetType="Border">
            <Setter Property="Background" Value="#15A06D"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="8" ShadowDepth="1" Opacity="0.25"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Trạng thái sân (giữ nguyên DataTrigger như QuanLySan) -->
        <Style x:Key="TrangThaiBorderStyle" TargetType="Border">
            <Setter Property="Background" Value="#FFFFFF"/>
            <Setter Property="BorderBrush" Value="#E5E7EB"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding TrangThai}" Value="Đang chơi">
                    <Setter Property="Background" Value="#DFF7EA"/>
                    <Setter Property="BorderBrush" Value="#1E7F4C"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding TrangThai}" Value="Trống">
                    <Setter Property="Background" Value="#EDF3FF"/>
                    <Setter Property="BorderBrush" Value="#3C5AA8"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding TrangThai}" Value="Đã đặt">
                    <Setter Property="Background" Value="#FFF4E3"/>
                    <Setter Property="BorderBrush" Value="#B76B00"/>
                </DataTrigger>
                <DataTrigger Binding="{Binding TrangThai}" Value="Bảo trì">
                    <Setter Property="Background" Value="#FFE5E5"/>
                    <Setter Property="BorderBrush" Value="#CC0000"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <!-- =================== LAYOUT =================== -->
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="220"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- ===== Sidebar (fixed / negative) ===== -->
        <Border Grid.Column="0" Background="White" BorderBrush="{StaticResource ColBorder}" BorderThickness="0,0,1,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Logo -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="16" VerticalAlignment="Top">
                    <Ellipse Width="28" Height="28" Fill="#2BB673"/>
                    <StackPanel Margin="8,0,0,0">
                        <TextBlock Text="Sân Cầu Lông" FontWeight="SemiBold"/>
                        <TextBlock Text="Củ Chi" Foreground="#888" FontSize="12"/>
                    </StackPanel>
                </StackPanel>

                <!-- Menu -->
                <StackPanel Grid.Row="1" Margin="4,0,4,0">
                    <!-- Active: Tổng quan -->
                    <Border Style="{StaticResource MenuItemActive}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📊" Margin="4,0,8,0" Foreground="White" VerticalAlignment="Center"/>
                            <TextBlock Text="Tổng quan" Foreground="White" FontWeight="SemiBold" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <Border Style="{StaticResource MenuItemNormal}" MouseLeftButtonDown="Menu_QuanLySan">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🏆" Margin="4,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Quản lý sân" Foreground="{StaticResource ColText}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <Border Style="{StaticResource MenuItemNormal}" MouseLeftButtonDown="Menu_DatSan">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📅" Margin="4,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Đặt sân" Foreground="{StaticResource ColText}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <Border Style="{StaticResource MenuItemNormal}" MouseLeftButtonDown="Menu_KhachHang">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="👤" Margin="4,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Khách hàng" Foreground="{StaticResource ColText}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <Border Style="{StaticResource MenuItemNormal}" MouseLeftButtonDown="Menu_ThanhToan">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="💳" Margin="4,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Thanh toán" Foreground="{StaticResource ColText}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <Border Style="{StaticResource MenuItemNormal}" MouseLeftButtonDown="Menu_KhoPOS">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🧾" Margin="4,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Kho &amp; POS" Foreground="{StaticResource ColText}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <Border Style="{StaticResource MenuItemNormal}" MouseLeftButtonDown="Menu_NhanVien">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🧑‍💼" Margin="4,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Nhân viên" Foreground="{StaticResource ColText}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <Border Style="{StaticResource MenuItemNormal}" MouseLeftButtonDown="Menu_BaoCao">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📈" Margin="4,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Báo cáo" Foreground="{StaticResource ColText}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>

                    <Border Style="{StaticResource MenuItemNormal}" MouseLeftButtonDown="Menu_CaiDat">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="⚙" Margin="4,0,8,0" VerticalAlignment="Center"/>
                            <TextBlock Text="Cài đặt" Foreground="{StaticResource ColText}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Admin -->
                <Border Grid.Row="2" Margin="10,8,10,12" Padding="12"
                        BorderBrush="{StaticResource ColBorder}" BorderThickness="1" CornerRadius="12">
                    <DockPanel>
                        <Ellipse Width="32" Height="32" Fill="#2BB673" DockPanel.Dock="Left"/>
                        <StackPanel Margin="10,0,0,0">
                            <TextBlock Text="Admin User" FontWeight="SemiBold" />
                            <TextBlock Text="Quản lý" Foreground="#889" FontSize="12"/>
                        </StackPanel>
                        <Border HorizontalAlignment="Right" VerticalAlignment="Center"
                                CornerRadius="12" BorderThickness="1" BorderBrush="{StaticResource ColBorder}"
                                Padding="6,4" Margin="8,0,0,0">
                            <TextBlock Text="↦" />
                        </Border>
                    </DockPanel>
                </Border>
            </Grid>
        </Border>

        <!-- ===== Content (header cố định) ===== -->
        <Grid Grid.Column="1" Margin="16,10,16,16">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Header: Search + Bell + Date -->
                <RowDefinition Height="Auto"/>
                <!-- Title + Buttons -->
                <RowDefinition Height="*"/>
                <!-- Body -->
            </Grid.RowDefinitions>

            <!-- Header -->
            <Grid Grid.Row="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Search -->


                <!-- Bell + Today -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="12,0,0,0">
                    <Border Width="36" Height="36" CornerRadius="18" Background="White"
                            BorderBrush="{StaticResource ColBorder}" BorderThickness="1"
                            HorizontalAlignment="Right" Margin="0,0,10,0">
                        <TextBlock Text="🔔" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <TextBlock Foreground="#7A8A83" VerticalAlignment="Center">
                        <TextBlock.Text>
                            <Binding Source="{x:Static sys:DateTime.Now}" StringFormat="{}{0:dddd, dd MMMM, yyyy}"/>
                        </TextBlock.Text>
                    </TextBlock>
                </StackPanel>
            </Grid>

            <!-- Title + Buttons -->
            <Grid Grid.Row="1" Margin="0,12,0,10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="78*"/>
                    <ColumnDefinition Width="73*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Orientation="Vertical" VerticalAlignment="Center" Grid.ColumnSpan="3" Margin="0,0,105,0">
                    <TextBlock Text="Tổng quan hệ thống" FontSize="16" FontWeight="SemiBold" Foreground="{StaticResource ColText}"/>
                    <TextBlock Text="Chào mừng trở lại! Đây là tổng quan hoạt động hôm nay." Foreground="{StaticResource ColSub}" FontSize="12"/>
                </StackPanel>

                <Border Grid.Column="1" Margin="427,0,10,0" Style="{StaticResource BtnOutline}" Grid.ColumnSpan="2">
                    <TextBlock Text="Xuất báo cáo" Foreground="#2BB673" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="1,0,0,0"/>
                </Border>

                <Border Grid.Column="2" Style="{StaticResource BtnSolid}" MouseLeftButtonDown="btnDatSanMoi" Grid.ColumnSpan="2" Margin="105,0,0,0">
                    <TextBlock Text="Đặt sân mới" Foreground="White" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                </Border>
            </Grid>

            <!-- Body -->
            <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
                <StackPanel>

                    <!-- KPI 4 thẻ -->
                    <UniformGrid Columns="4" Margin="0,0,0,12">
                        <Border Style="{StaticResource CardBorder}" Padding="16" Margin="8">
                            <StackPanel>
                                <TextBlock Text="Doanh thu hôm nay" Foreground="#678"/>
                                <TextBlock Text="{Binding DoanhThuHomNay, StringFormat={}{0:N0}đ}" FontSize="20" FontWeight="Bold"/>
                                <TextBlock Text="{Binding BienDongDoanhThu}" Foreground="#16A34A" Margin="0,6,0,0"/>
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource CardBorder}" Padding="16" Margin="8">
                            <StackPanel>
                                <TextBlock Text="Số lượt đặt sân" Foreground="#678"/>
                                <TextBlock Text="{Binding SoLuotDatSan}" FontSize="20" FontWeight="Bold"/>
                                <TextBlock Text="{Binding BienDongLuotDat}" Foreground="#16A34A" Margin="0,6,0,0"/>
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource CardBorder}" Padding="16" Margin="8">
                            <StackPanel>
                                <TextBlock Text="Hội viên mới" Foreground="#678"/>
                                <TextBlock Text="{Binding HoiVienMoi}" FontSize="20" FontWeight="Bold"/>
                                <TextBlock Text="{Binding BienDongHoiVien}" Foreground="#16A34A" Margin="0,6,0,0"/>
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource CardBorder}" Padding="16" Margin="8">
                            <StackPanel>
                                <TextBlock Text="Tỉ lệ lấp đầy" Foreground="#678"/>
                                <TextBlock Text="{Binding TiLeLapDay, StringFormat={}{0:P0}}" FontSize="20" FontWeight="Bold"/>
                                <TextBlock Text="{Binding BienDongLapDay}" Foreground="#DC2626" Margin="0,6,0,0"/>
                            </StackPanel>
                        </Border>
                    </UniformGrid>

                    <!-- Tình trạng sân + Top hội viên -->
                    <Grid Margin="0,0,0,12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Tình trạng sân -->
                        <Border Grid.Column="0" Style="{StaticResource CardBorder}" Margin="8">
                            <StackPanel>
                                <DockPanel Margin="0,0,0,8">
                                    <TextBlock Text="🟡" DockPanel.Dock="Left" Margin="0,0,6,0"/>
                                    <TextBlock Text="Tình trạng sân" FontWeight="SemiBold"/>
                                </DockPanel>

                                <ItemsControl ItemsSource="{Binding TinhTrangSan}">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <UniformGrid Columns="3"/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Style="{StaticResource CardBorder}" Padding="12" Margin="8">
                                                <StackPanel>
                                                    <TextBlock Text="{Binding TenSan}" FontWeight="SemiBold"/>
                                                    <Border CornerRadius="10" Padding="8,2" Margin="0,6,0,0"
                                                            Style="{StaticResource TrangThaiBorderStyle}">
                                                        <TextBlock Text="{Binding TrangThai}" FontSize="12" FontWeight="SemiBold"/>
                                                    </Border>
                                                    <TextBlock Text="{Binding Den}" Foreground="#6B7E74" Margin="0,6,0,0" FontSize="12"/>
                                                </StackPanel>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>

                        <!-- Top hội viên -->
                        <Border Grid.Column="1" Style="{StaticResource CardBorder}" Margin="8">
                            <StackPanel>
                                <DockPanel Margin="0,0,0,8">
                                    <TextBlock Text="⭐" DockPanel.Dock="Left" Margin="0,0,6,0"/>
                                    <TextBlock Text="Top hội viên" FontWeight="SemiBold"/>
                                </DockPanel>

                                <ItemsControl ItemsSource="{Binding TopHoiVien}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <DockPanel Margin="0,6,0,6">
                                                <Border Width="36" Height="36" CornerRadius="18" Background="#F6F8F7" DockPanel.Dock="Left">
                                                    <TextBlock Text="{Binding TenVietTat}" VerticalAlignment="Center" HorizontalAlignment="Center" FontWeight="SemiBold"/>
                                                </Border>
                                                <StackPanel Margin="10,0,0,0">
                                                    <TextBlock Text="{Binding HoTen}"/>
                                                    <TextBlock Text="{Binding LuotChoi, StringFormat={}{0} lượt chơi}" Foreground="#6B7E74" FontSize="12"/>
                                                </StackPanel>
                                                <TextBlock Text="{Binding Diem, StringFormat={}{0} điểm}" DockPanel.Dock="Right" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                                            </DockPanel>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- Lịch đặt sân gần đây -->
                    <Border Style="{StaticResource CardBorder}" Margin="8">
                        <StackPanel>
                            <DockPanel Margin="0,0,0,8">
                                <TextBlock Text="📅" DockPanel.Dock="Left" Margin="0,0,6,0"/>
                                <TextBlock Text="Lịch đặt sân gần đây" FontWeight="SemiBold"/>
                            </DockPanel>

                            <ListView ItemsSource="{Binding LichDatGanDay}" BorderThickness="0">
                                <ListView.View>
                                    <GridView AllowsColumnReorder="False">
                                        <GridViewColumn Header="Sân" DisplayMemberBinding="{Binding TenSan}" Width="140"/>
                                        <GridViewColumn Header="Khách hàng" DisplayMemberBinding="{Binding KhachHang}" Width="220"/>
                                        <GridViewColumn Header="Thời gian" DisplayMemberBinding="{Binding KhoangGio}" Width="180"/>
                                        <GridViewColumn Header="Trạng thái" Width="120">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Border CornerRadius="10" Padding="8,2" Style="{StaticResource TrangThaiBorderStyle}">
                                                        <TextBlock Text="{Binding TrangThai}" FontSize="12" FontWeight="SemiBold"/>
                                                    </Border>
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                        </StackPanel>
                    </Border>

                </StackPanel>
            </ScrollViewer>
        </Grid>
    </Grid>
</Window>
