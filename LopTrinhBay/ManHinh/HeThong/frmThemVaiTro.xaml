<Window x:Class="QuanLiSanCauLong.LopTrinhBay.ManHinh.HeThong.frmThemVaiTro"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Thêm vai trò"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        SizeToContent="WidthAndHeight"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        MinWidth="720" MinHeight="560"
        MaxWidth="900">

    <!-- ===== RESOURCES: Palette + Styles ===== -->
    <Window.Resources>
        <!-- Palette -->
        <SolidColorBrush x:Key="ColText"      Color="#21382D"/>
        <SolidColorBrush x:Key="ColSub"       Color="#6B7E74"/>
        <SolidColorBrush x:Key="ColBorder"    Color="#E1F0E9"/>
        <SolidColorBrush x:Key="ColCard"      Color="White"/>
        <SolidColorBrush x:Key="ColAccent"    Color="#0FBF84"/>
        <SolidColorBrush x:Key="ColDanger"    Color="#F97373"/>

        <!-- Label nhỏ bên trên input -->
        <Style x:Key="FieldLabel" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource ColSub}"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="0,6,0,2"/>
        </Style>

        <!-- Khung input (Border) -->
        <Style x:Key="FieldBox" TargetType="Border">
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="BorderBrush" Value="{StaticResource ColBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="#F9FBFA"/>
            <Setter Property="Padding" Value="8,4"/>
        </Style>

        <!-- Nút text (Hủy) -->
        <Style x:Key="SecondaryButton" TargetType="Button">
            <Setter Property="Padding" Value="14,6"/>
            <Setter Property="MinWidth" Value="90"/>
            <Setter Property="Background" Value="#F3F4F6"/>
            <Setter Property="Foreground" Value="{StaticResource ColText}"/>
            <Setter Property="BorderBrush" Value="#E5E7EB"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="bd"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#E5E7EB"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="bd" Property="Opacity" Value="0.9"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Nút chính (Lưu vai trò) -->
        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Padding" Value="14,6"/>
            <Setter Property="MinWidth" Value="120"/>
            <Setter Property="Background" Value="{StaticResource ColAccent}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#0D7049"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="bd"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#0DAA78"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="bd" Property="Opacity" Value="0.9"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="bd" Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Header button (Minimize / Close) -->
        <Style x:Key="HeaderIconButton" TargetType="Button">
            <Setter Property="Width" Value="26"/>
            <Setter Property="Height" Value="26"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="bd"
                                CornerRadius="6"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#F3F4F6"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="bd" Property="Background" Value="#E5E7EB"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- DataGrid header & row -->
        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#F5F7FA"/>
            <Setter Property="Foreground" Value="{StaticResource ColSub}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="BorderBrush" Value="{StaticResource ColBorder}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="Padding" Value="8,6"/>
        </Style>

        <Style TargetType="DataGridRow">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="#F1F5F9"/>
            <Setter Property="Height" Value="32"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#F3FDF8"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <!-- ===== OUTER BORDER + SHADOW ===== -->
    <Border CornerRadius="14"
            Background="{StaticResource ColCard}"
            BorderBrush="#D7EAE2"
            BorderThickness="1"
            Padding="16"
            Margin="6">
        <Border.Effect>
            <DropShadowEffect BlurRadius="18" ShadowDepth="2" Opacity="0.35"/>
        </Border.Effect>

        <Grid MinWidth="620">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>   <!-- Header -->
                <RowDefinition Height="*"/>      <!-- Body -->
                <RowDefinition Height="Auto"/>   <!-- Footer -->
            </Grid.RowDefinitions>

            <!-- ===== HEADER ===== -->
            <Border Grid.Row="0"
                    Background="White"
                    CornerRadius="10"
                    BorderBrush="{StaticResource ColBorder}"
                    BorderThickness="0,0,0,1">
                <Grid MouseDown="Header_MouseDown" Margin="4,0,4,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Orientation="Vertical" Margin="8,6,0,6">
                        <TextBlock Text="Thêm vai trò mới"
                                   FontSize="16"
                                   FontWeight="Bold"
                                   Foreground="{StaticResource ColText}"/>
                        <TextBlock Text="Thiết lập quyền truy cập cho từng nhóm nhân viên"
                                   FontSize="11"
                                   Foreground="{StaticResource ColSub}"/>
                    </StackPanel>

                    <!-- Minimize (nếu cần) -->
                    <Button Grid.Column="1"
                            Style="{StaticResource HeaderIconButton}"
                            Click="BtnMinimize_Click"
                            ToolTip="Thu nhỏ">
                        <TextBlock Text="—" FontSize="14" FontWeight="Bold"/>
                    </Button>

                    <!-- Close -->
                    <Button Grid.Column="2"
                            Style="{StaticResource HeaderIconButton}"
                            Click="BtnClose_Click"
                            ToolTip="Đóng">
                        <TextBlock Text="✕" FontSize="12" FontWeight="Bold" Foreground="{StaticResource ColDanger}"/>
                    </Button>
                </Grid>
            </Border>

            <!-- ===== BODY ===== -->
            <Grid Grid.Row="1" Margin="0,10,0,8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>  <!-- Thông tin vai trò -->
                    <RowDefinition Height="*"/>     <!-- Bảng quyền -->
                </Grid.RowDefinitions>

                <!-- ==== THÔNG TIN VAI TRÒ ==== -->
                <Border Grid.Row="0"
                        CornerRadius="10"
                        BorderBrush="#E0F2FE"
                        BorderThickness="1"
                        Background="#F5FAFF"
                        Padding="12"
                        Margin="0,0,0,10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="1.2*"/>
                            <ColumnDefinition Width="0.8*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Cột trái: Mã + Tên -->
                        <StackPanel Grid.Column="0" Margin="0,0,8,0">
                            <TextBlock Text="Mã vai trò" Style="{StaticResource FieldLabel}"/>
                            <Border Style="{StaticResource FieldBox}">
                                <!-- MaVaiTro: readonly, auto sinh -->
                                <TextBox BorderThickness="0"
                                         Background="Transparent"
                                         IsReadOnly="True"
                                         Foreground="{StaticResource ColText}"
                                         Text="{Binding MaVaiTro}"/>
                            </Border>

                            <TextBlock Text="Tên vai trò" Style="{StaticResource FieldLabel}"/>
                            <Border Style="{StaticResource FieldBox}">
                                <TextBox BorderThickness="0"
                                         Background="Transparent"
                                         Text="{Binding TenVaiTro, UpdateSourceTrigger=PropertyChanged}"/>
                            </Border>

                            <!-- Áp dụng cho loại nhân viên -->
                            <TextBlock Text="Áp dụng cho loại nhân viên" Style="{StaticResource FieldLabel}" Margin="0,6,0,4"/>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                <CheckBox Content="Quản lý"
                                          Margin="0,0,12,0"
                                          IsChecked="{Binding ApDungQuanLy}"/>
                                <CheckBox Content="Full-time"
                                          Margin="0,0,12,0"
                                          IsChecked="{Binding ApDungFullTime}"/>
                                <CheckBox Content="Part-time"
                                          IsChecked="{Binding ApDungPartTime}"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Cột phải: Mô tả -->
                        <StackPanel Grid.Column="1" Margin="8,0,0,0">
                            <TextBlock Text="Mô tả" Style="{StaticResource FieldLabel}"/>
                            <Border Style="{StaticResource FieldBox}" Height="96">
                                <TextBox BorderThickness="0"
                                         Background="Transparent"
                                         TextWrapping="Wrap"
                                         AcceptsReturn="True"
                                         VerticalScrollBarVisibility="Auto"
                                         Text="{Binding MoTa}"/>
                            </Border>

                            <!-- Ghi chú nhỏ -->
                            <TextBlock Text="Gợi ý: Mô tả quyền chính của vai trò này để dễ quản lý về sau."
                                       FontSize="11"
                                       Foreground="{StaticResource ColSub}"
                                       TextWrapping="Wrap"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- ==== BẢNG QUYỀN CHI TIẾT ==== -->
                <Border Grid.Row="1"
                        CornerRadius="10"
                        BorderBrush="{StaticResource ColBorder}"
                        BorderThickness="1"
                        Background="White"
                        Padding="10">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Tiêu đề + hint -->
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,6">
                            <TextBlock Text="Quyền chi tiết theo chức năng"
                                       FontWeight="SemiBold"
                                       Foreground="{StaticResource ColText}"/>
                            <TextBlock Text="  –  tick các thao tác được phép"
                                       Foreground="{StaticResource ColSub}"
                                       FontSize="11"
                                       VerticalAlignment="Center"/>
                        </StackPanel>

                        <!-- DataGrid quyền -->
                        <DataGrid Grid.Row="1"
                                  ItemsSource="{Binding DanhSachQuyen}"
                                  AutoGenerateColumns="False"
                                  HeadersVisibility="Column"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  GridLinesVisibility="None"
                                  BorderThickness="0"
                                  RowHeaderWidth="0"
                                  MinHeight="220">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Chức năng"
                                                    Binding="{Binding TenChucNang}"
                                                    Width="*"/>

                                <DataGridCheckBoxColumn Header="Xem"
                                                        Binding="{Binding QuyenXem}"
                                                        Width="60"/>

                                <DataGridCheckBoxColumn Header="Thêm"
                                                        Binding="{Binding QuyenThem}"
                                                        Width="60"/>

                                <DataGridCheckBoxColumn Header="Sửa"
                                                        Binding="{Binding QuyenSua}"
                                                        Width="60"/>

                                <DataGridCheckBoxColumn Header="Xóa"
                                                        Binding="{Binding QuyenXoa}"
                                                        Width="60"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
            </Grid>

            <!-- ===== FOOTER ===== -->
            <Grid Grid.Row="2" Margin="0,4,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Gợi ý bên trái -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="Mẹo: "
                               FontSize="11"
                               FontWeight="SemiBold"
                               Foreground="{StaticResource ColSub}"/>
                    <TextBlock Text="hãy dùng ít vai trò nhưng rõ ràng (VD: Quản lý, Lễ tân, Thu ngân…)."
                               FontSize="11"
                               Foreground="{StaticResource ColSub}"/>
                </StackPanel>

                <!-- Nút Hủy -->
                <Button Grid.Column="1"
                        Style="{StaticResource SecondaryButton}"
                        Margin="0,0,8,0"
                        Click="BtnCancel_Click">
                    Hủy
                </Button>

                <!-- Nút Lưu -->
                <Button Grid.Column="2"
                        Style="{StaticResource PrimaryButton}"
                        Click="BtnSave_Click">
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <TextBlock Text="&#xE8FB;" FontFamily="Segoe MDL2 Assets" Margin="0,0,6,0"/>
                        <TextBlock Text="Lưu vai trò"/>
                    </StackPanel>
                </Button>
            </Grid>
        </Grid>
    </Border>
</Window>
