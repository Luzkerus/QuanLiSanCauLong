<UserControl x:Class="QuanLiSanCauLong.LopTrinhBay.ManHinh.Controls.ucSidebar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="720" d:DesignWidth="220"
             x:Name="Root"
             Width="220"
             Background="White">

    <!-- ================= Resources ================= -->
    <UserControl.Resources>
        <SolidColorBrush x:Key="ColText"   Color="#21382D"/>
        <SolidColorBrush x:Key="ColBorder" Color="#E6EFEA"/>
        <SolidColorBrush x:Key="ColActiveBg" Color="#0FBF84"/>

        <!-- Item đang chọn -->
        <Style x:Key="MenuItemActive" TargetType="Border">
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Background" Value="#0FBF84"/>
            <Setter Property="BorderBrush" Value="#0FBF84"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Margin" Value="6,4,6,0"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="Cursor" Value="Hand"/>

            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="8"
                              ShadowDepth="0"
                              Opacity="0.22"
                              Color="#66B98D"/>
                </Setter.Value>
            </Setter>

            <Style.Triggers>
                <!-- Hover trên item đang chọn: chỉ đổi hơi đậm -->
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#0DAA78"/>
                </Trigger>
            </Style.Triggers>
        </Style>



        <!-- Item bình thường -->
        <Style x:Key="MenuItemNormal" TargetType="Border">
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="{StaticResource ColBorder}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Margin" Value="6,4,6,0"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="Cursor" Value="Hand"/>

            <!-- mặc định: không bóng -->
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="0"
                              ShadowDepth="0"
                              Opacity="0"/>
                </Setter.Value>
            </Setter>

            <Style.Triggers>
                <!-- Hover: nổi nhẹ, nền pastel theo gradient mới -->
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="BorderBrush" Value="#0FBF84"/>

                    <Setter Property="Background">
                        <Setter.Value>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <GradientStop Color="#E6FFF5" Offset="0"/>
                                <GradientStop Color="#FFF4C2" Offset="1"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>

                    <Setter Property="Effect">
                        <Setter.Value>
                            <DropShadowEffect BlurRadius="8"
                                      ShadowDepth="0"
                                      Opacity="0.20"
                                      Color="#88C9A5"/>
                            <!-- xanh pastel hơi đậm -->
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>



        <!-- Label menu: ẩn khi thu nhỏ -->
        <Style x:Key="MenuLabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Foreground" Value="{StaticResource ColText}"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="4,0,0,0"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsExpanded, ElementName=Root}" Value="False">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- Text logo / admin ẩn khi thu nhỏ -->
        <Style x:Key="CollapseWithSidebar" TargetType="TextBlock">
            <Setter Property="Visibility" Value="Visible"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsExpanded, ElementName=Root}" Value="False">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- Border phụ ẩn khi thu nhỏ -->
        <Style x:Key="CollapseBorderWithSidebar" TargetType="Border">
            <Setter Property="Visibility" Value="Visible"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsExpanded, ElementName=Root}" Value="False">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- Nút Logout: dựa trên CollapseBorderWithSidebar, thêm màu & hover -->
        <Style x:Key="LogoutBorderStyle"
           TargetType="Border"
           BasedOn="{StaticResource CollapseBorderWithSidebar}">
            <Setter Property="CornerRadius" Value="999"/>
            <Setter Property="Background" Value="#FFF7F7"/>
            <Setter Property="BorderBrush" Value="#F5C2C2"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="6,2"/>
            <Setter Property="Cursor" Value="Hand"/>

            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FFE5E5"/>
                    <Setter Property="BorderBrush" Value="#E55353"/>
                </Trigger>
            </Style.Triggers>
        </Style>


        <!-- Avatar cho Admin-->
        <ImageBrush x:Key="AvatarAdminBrush"
                ImageSource="/LopTrinhBay/TaiNguyen/Logo/admin.png"
                Stretch="UniformToFill"/>

        <!-- Avatar cho quản lý -->
        <ImageBrush x:Key="AvatarManagerBrush"
                ImageSource="/LopTrinhBay/TaiNguyen/Logo/quanl.jpg"
                Stretch="UniformToFill"/>

        <!-- Avatar cho nhân viên -->
        <ImageBrush x:Key="AvatarStaffBrush"
                ImageSource="/LopTrinhBay/TaiNguyen/Logo/nhanvien.png"
                Stretch="UniformToFill"/>


    </UserControl.Resources>

    <!-- ================= Layout chính ================= -->
    <Grid>
        <!-- Thân sidebar -->
        <Border BorderBrush="{StaticResource ColBorder}"
        BorderThickness="0,0,1,0">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <!-- Xanh pastel nâng tone -->
                    <GradientStop Color="#C9FFE9" Offset="0"/>
                    <!-- Vàng pastel nâng tone -->
                    <GradientStop Color="#FFF4C2" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>

            <!-- Shadow nhẹ cho sidebar -->
            <Border.Effect>
                <DropShadowEffect BlurRadius="18"
                          ShadowDepth="0"
                          Opacity="0.18"
                          Color="#000000"/>
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- ===== Row 0: Logo ===== -->
                <StackPanel Grid.Row="0"
                            Orientation="Horizontal"
                            Margin="10,10,10,6"
                            VerticalAlignment="Center">
                    <!-- Logo tròn -->
                    <Ellipse Width="42" Height="42">
                        <Ellipse.Fill>
                            <ImageBrush ImageSource="/LopTrinhBay/TaiNguyen/Logo/sancaulongcuchi-logo.png"
                        Stretch="UniformToFill"/>
                        </Ellipse.Fill>
                    </Ellipse>
                    <StackPanel Margin="8,0,0,0" VerticalAlignment="Center">
                        <TextBlock Text="Sân Cầu Lông"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   Style="{StaticResource CollapseWithSidebar}"/>
                        <TextBlock Text="Củ Chi"
                                   Foreground="#888"
                                   FontSize="16"
                                   Style="{StaticResource CollapseWithSidebar}"/>
                    </StackPanel>
                </StackPanel>

                <!-- ===== Row 1: Menu ===== -->
                <StackPanel x:Name="MenuPanel" Grid.Row="1" Margin="4,4,4,0">

                    <!-- Tổng quan -->
                    <Border x:Name="Item_Overview"
                            Style="{StaticResource MenuItemNormal}"
                            Tag="overview"
                            MouseLeftButtonDown="MenuItem_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📊"
                                       Margin="4,0,8,0"
                                       VerticalAlignment="Center"/>
                            <TextBlock Text="Tổng quan" FontSize="15" FontWeight="SemiBold"
                                       Style="{StaticResource MenuLabelStyle}"/>
                        </StackPanel>
                    </Border>

                    <!-- Quản lý sân -->
                    <Border x:Name="Item_Courts"
                            Style="{StaticResource MenuItemNormal}"
                            Tag="courts"
                            MouseLeftButtonDown="MenuItem_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🏆"
                                       Margin="4,0,8,0"
                                       VerticalAlignment="Center"/>
                            <TextBlock Text="Quản lý sân" FontSize="15" FontWeight="SemiBold"
                                       Style="{StaticResource MenuLabelStyle}"/>
                        </StackPanel>
                    </Border>

                    <!-- Đặt sân -->
                    <Border x:Name="Item_Booking"
                            Style="{StaticResource MenuItemNormal}"
                            Tag="booking"
                            MouseLeftButtonDown="MenuItem_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📅"
                                       Margin="4,0,8,0"
                                       VerticalAlignment="Center"/>
                            <TextBlock Text="Đặt sân" FontSize="15" FontWeight="SemiBold"
                                       Style="{StaticResource MenuLabelStyle}"/>
                        </StackPanel>
                    </Border>

                    <!-- Khách hàng -->
                    <Border x:Name="Item_Customers"
                            Style="{StaticResource MenuItemNormal}"
                            Tag="customers"
                            MouseLeftButtonDown="MenuItem_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="👤"
                                       Margin="4,0,8,0"
                                       VerticalAlignment="Center"/>
                            <TextBlock Text="Khách hàng" FontSize="15" FontWeight="SemiBold"
                                       Style="{StaticResource MenuLabelStyle}"/>
                        </StackPanel>
                    </Border>

                    <!-- Thanh toán -->
                    <Border x:Name="Item_Payment"
                            Style="{StaticResource MenuItemNormal}"
                            Tag="payment"
                            MouseLeftButtonDown="MenuItem_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="💳"
                                       Margin="4,0,8,0"
                                       VerticalAlignment="Center"/>
                            <TextBlock Text="Thanh toán" FontSize="15" FontWeight="SemiBold"
                                       Style="{StaticResource MenuLabelStyle}"/>
                        </StackPanel>
                    </Border>

                    <!-- Kho & POS -->
                    <Border x:Name="Item_POS"
                            Style="{StaticResource MenuItemNormal}"
                            Tag="pos"
                            MouseLeftButtonDown="MenuItem_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🧾"
                                       Margin="4,0,8,0"
                                       VerticalAlignment="Center"/>
                            <TextBlock Text="Kho &amp; POS" FontSize="15" FontWeight="SemiBold"
                                       Style="{StaticResource MenuLabelStyle}"/>
                        </StackPanel>
                    </Border>

                    <!-- Nhân viên -->
                    <Border x:Name="Item_Staff"
                            Style="{StaticResource MenuItemNormal}"
                            Tag="staff"
                            MouseLeftButtonDown="MenuItem_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🧑‍💼"
                                       Margin="4,0,8,0"
                                       VerticalAlignment="Center"/>
                            <TextBlock Text="Nhân viên" FontSize="15" FontWeight="SemiBold"
                                       Style="{StaticResource MenuLabelStyle}"/>
                        </StackPanel>
                    </Border>

                    <!-- Báo cáo -->
                    <Border x:Name="Item_Reports"
                            Style="{StaticResource MenuItemNormal}"
                            Tag="reports"
                            MouseLeftButtonDown="MenuItem_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="📈"
                                       Margin="4,0,8,0"
                                       VerticalAlignment="Center"/>
                            <TextBlock Text="Báo cáo" FontSize="15" FontWeight="SemiBold"
                                       Style="{StaticResource MenuLabelStyle}"/>
                        </StackPanel>
                    </Border>

                    <!-- Cài đặt -->
                    <Border x:Name="Item_Settings"
                            Style="{StaticResource MenuItemNormal}"
                            Tag="settings"
                            MouseLeftButtonDown="MenuItem_Click">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="⚙"
                                       Margin="4,0,8,0"
                                       VerticalAlignment="Center"/>
                            <TextBlock Text="Cài đặt" FontSize="15" FontWeight="SemiBold"
                                       Style="{StaticResource MenuLabelStyle}"/>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- ===== Row 2: Admin info (2 trạng thái) ===== -->
                <Grid Grid.Row="2" Margin="10,8,10,12">

                    <!-- 1. Sidebar MỞ: card admin đầy đủ -->
                    <Border x:Name="AdminCardExpanded"
                            Padding="12"
                            BorderBrush="{StaticResource ColBorder}"
                            BorderThickness="1"
                            CornerRadius="12">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Setter Property="Visibility" Value="Visible"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsExpanded, ElementName=Root}" Value="False">
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>

                        <DockPanel>
                            <!-- Avatar theo vai trò -->
                            <Ellipse Width="32" Height="32" DockPanel.Dock="Left">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <Setter Property="Fill" Value="{StaticResource AvatarAdminBrush}"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding AdminRole, ElementName=Root}" Value="Quản lý">
                                                <Setter Property="Fill" Value="{StaticResource AvatarManagerBrush}"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding AdminRole, ElementName=Root}" Value="Nhân viên">
                                                <Setter Property="Fill" Value="{StaticResource AvatarStaffBrush}"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                            </Ellipse>

                            <StackPanel Margin="10,0,0,0"
                                        VerticalAlignment="Center">
                                <TextBlock Text="{Binding AdminName, ElementName=Root, FallbackValue=Admin User}"
                                           FontWeight="SemiBold"
                                           FontSize="13"
                                           Style="{StaticResource CollapseWithSidebar}"/>

                                <TextBlock Text="{Binding AdminRole, ElementName=Root, FallbackValue=Admin}"
                                           Foreground="#889"
                                           FontSize="11"
                                           Style="{StaticResource CollapseWithSidebar}"/>

                            </StackPanel>

                            <!-- Logout chỉ icon -->
                            <Border HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    Margin="8,0,0,0"
                                    Style="{StaticResource LogoutBorderStyle}"
                                    MouseLeftButtonDown="btnLogOut_Click">
                                <TextBlock Text="⎋"
                                           Foreground="#E55353"
                                           FontSize="14"
                                           FontWeight="Bold"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"/>
                            </Border>
                        </DockPanel>
                    </Border>

                    <!-- 2. Sidebar THU NHỎ: Avatar nhỏ + tooltip -->
                    <Border x:Name="AdminCardCollapsed"
                            Width="44" Height="44"
                            CornerRadius="22"
                            Background="White"
                            BorderBrush="{StaticResource ColBorder}"
                            BorderThickness="1"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Bottom"
                            Padding="4"
                            ToolTipService.InitialShowDelay="200"
                            ToolTipService.ShowDuration="5000"
                            MouseLeftButtonDown="btnLogOut_Click">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsExpanded, ElementName=Root}" Value="False">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>

                        <Border.ToolTip>
                            <StackPanel Margin="4">
                                <TextBlock Text="{Binding AdminName, ElementName=Root, FallbackValue=Admin User}"
                                           FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding AdminRole, ElementName=Root, FallbackValue=Admin}"
                                           Foreground="#666"
                                           FontSize="12"/>
                                <TextBlock Text="Nhấn để đăng xuất"
                                           Foreground="#999"
                                           FontSize="11"
                                           Margin="0,4,0,0"/>
                            </StackPanel>
                        </Border.ToolTip>

                        <Ellipse>
                            <Ellipse.Style>
                                <Style TargetType="Ellipse">
                                    <Setter Property="Fill" Value="{StaticResource AvatarAdminBrush}"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding AdminRole, ElementName=Root}" Value="Quản lý">
                                            <Setter Property="Fill" Value="{StaticResource AvatarManagerBrush}"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding AdminRole, ElementName=Root}" Value="Nhân viên">
                                            <Setter Property="Fill" Value="{StaticResource AvatarStaffBrush}"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Ellipse.Style>
                        </Ellipse>
                    </Border>

                </Grid>
            </Grid>
        </Border>

        <!-- ===== Nút toggle tròn, nằm ngoài mép phải ===== -->
        <Button x:Name="BtnToggle"
                Width="38" Height="38"
                Click="BtnToggle_Click"
                HorizontalAlignment="Right"
                VerticalAlignment="Top"
                Margin="0,12,-45,0"
                Background="Transparent"
                BorderThickness="0"
                Cursor="Hand">

            <Button.Template>
                <ControlTemplate TargetType="Button">
                    <Grid>
                        <!-- Nền tròn trắng -->
                        <Ellipse x:Name="BaseCircle"
                         Fill="White"/>

                        <!-- Viền xanh chỉ hiện khi hover -->
                        <Ellipse x:Name="HoverRing"
                         Fill="Transparent"
                         Stroke="#0FBF84"
                         StrokeThickness="1.6"
                         Opacity="0"/>

                        <!-- Icon 3 gạch -->
                        <StackPanel Orientation="Vertical"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center">
                            <Rectangle Height="3" Width="17"
                               Fill="#222"
                               RadiusX="1.5" RadiusY="1.5"
                               Margin="0,0,0,4"/>
                            <Rectangle Height="3" Width="17"
                               Fill="#222"
                               RadiusX="1.5" RadiusY="1.5"
                               Margin="0,0,0,4"/>
                            <Rectangle Height="3" Width="17"
                               Fill="#222"
                               RadiusX="1.5" RadiusY="1.5"/>
                        </StackPanel>
                    </Grid>

                    <ControlTemplate.Triggers>
                        <!-- Hover: hiện viền xanh -->
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="HoverRing"
                            Property="Opacity"
                            Value="1"/>
                        </Trigger>

                        <!-- Nhấn chuột: nền hơi xanh nhạt -->
                        <Trigger Property="IsPressed" Value="True">
                            <Setter TargetName="BaseCircle"
                            Property="Fill"
                            Value="#E6FFF5"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Button.Template>
        </Button>
    </Grid>
</UserControl>
